<!DOCTYPE HTML>
<html><!-- InstanceBegin template="/Templates/main.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
	<title>Mobile App</title>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" >
	
    <link href="css/jquerymobile.min.css" type="text/css" rel="stylesheet">
    <link href="css/style.css" type="text/css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="css/font-awesome/css/font-awesome.min.css">
    <link href="css/media-query.css" type="text/css" rel="stylesheet">
	<script src="js/jquery.min.js"></script>
   	<script src="js/jquerymobile.min.js"></script>
    <script src="js/logger.js"></script>
	<script src="cordova.js"></script>
	<script src="PushNotification.js"></script>
  
	<script src="js/functions.js"></script>
	<!-- InstanceBeginEditable name="EditableHead" -->
    <script src="js/jquery.geocomplete.js"></script>
	<!-- InstanceEndEditable --> 
</head>

<body>
	<div data-role="page">
	<div id="page">
	<header data-role="none">
		<div id="header-logo">
			<div class="tile-box"><a href="dashboard.html" rel="external"><img src="images/taxi-logo.png" alt="Get a Taxi App"></a></div>
		</div>
		<!-- InstanceBeginEditable name="EditableHeader" -->
	<script type="text/javascript">
    
    function callbackTarif(data) {
					//alert(option);
        
        if(data.success != false) {
			setLocalStorage('price',data.data.Tarif);
			setLocalStorage('option',data.data);
			console.log(data.data);
			console.log(data.data.Tarif);
			
			location.replace('review-offer.html');
			//return false;

        } else {
            console.log('noooooooo');
            showMessage(data);
        }
    }
    
    </script>

	  	<script type="text/javascript">
		  	$(document).ready(function() {
				
				clearLocalStorage('price');
				
	        	$(".more-options-hidden, .panel-1").css("display","none");
			});
			$('.more-options').click(function(){
				$(".more-options-hidden").slideToggle("8000");
			});
	  	</script>
		<script> 
    
            $(document).ready(function(){
            
            $(".flip-1").click(function(){
            
            $(".panel-1").fadeToggle(1000);
            
            });
            
            });

		</script>
		<script type="text/javascript">
		
		function setQuoteData(form) {
		
				var src = $('#pickup').val();
				var dst = $('#dropoff').val();

				var src_convrt = src.replace(" ","+");
				var dst_convrt = dst.replace(" ","+");

				var source_data = 'http://maps.googleapis.com/maps/api/geocode/json?address='+src_convrt+'&sensor=true';
				var destination_data = 'http://maps.googleapis.com/maps/api/geocode/json?address='+dst_convrt+'&sensor=true';

				var source_post_code;
				var destination_post_code;
				var source_current_latitude;
				var source_current_longitude;

				$.getJSON(source_data,function(result){
				  	$.each(result.results, function(i, field){
						$.each(field.address_components, function(i, obj_type){
                            if(inArray('postal_code_prefix',obj_type.types)||
                             	 inArray('postal_code',obj_type.types)){
                             		//source_post_code = obj_type.short_name;
	                             	source_post_code =obj_type.short_name.substring(0, obj_type.short_name.indexOf(" "));
	                             	document.getElementById("from_post_code").value = new String(source_post_code);
                             		console.log(source_post_code);
                            }
						});
						
						$.each(field.geometry.location, function(i, obj_return){
							if(i =='lat') source_current_latitude = obj_return;
							if(i =='lng') source_current_longitude = obj_return;	
						});
						document.getElementById("current_location_latitude").value = new String(source_current_latitude);
						document.getElementById("current_location_longitude").value = new String(source_current_longitude);						
						console.log(source_current_latitude, source_current_longitude);
					});
				});
				
				
				
				$.getJSON(destination_data,function(result){
				  	$.each(result.results, function(i, field){
						$.each(field.address_components, function(i, obj_type){
                            if(inArray('postal_code_prefix',obj_type.types)||
                             	 inArray('postal_code',obj_type.types)){
                            		//destination_post_code = obj_type.short_name;
                            		destination_post_code =obj_type.short_name.substring(0, obj_type.short_name.indexOf(" "));
                            		document.getElementById("to_post_code").value = new String(destination_post_code);
                            		console.log(destination_post_code);
									
                            }
						});
					});
					submitForm(form);
					alert('yes');

				});
				
			return false;
		}
		</script>
        <script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places"></script>
        <script>
	        function inArray(needle, haystack) {
			    var length = haystack.length;
			    for(var i = 0; i < length; i++) {
			        if(haystack[i] == needle) return true;
			    }
			    return false;
			}

	      	$(function(){
	        
	        $("#pickup").geocomplete()
	          .bind("geocode:result", function(event, result){
	            $.log("Result: " + result.formatted_address);
	          })
	          .bind("geocode:error", function(event, status){
	            $.log("ERROR: " + status);
	          })
	          .bind("geocode:multiple", function(event, results){
	            $.log("Multiple: " + results.length + " results found");
	          });
			  
			  $("#dropoff").geocomplete()
	          .bind("geocode:result", function(event, result){
	            $.log("Result: " + result.formatted_address);
	          })
	          .bind("geocode:error", function(event, status){
	            $.log("ERROR: " + status);
	          })
	          .bind("geocode:multiple", function(event, results){
	            $.log("Multiple: " + results.length + " results found");
	          });
      });
    </script>
		<!-- InstanceEndEditable -->
	</header>
	<div data-role="none" id="content">
		<!-- InstanceBeginEditable name="EditableBody" -->
    
			 <div class="get-quote-bg content-position">
             
             	<h2>Get A Quote</h2>
               
				<form method="POST" enctype="multipart/form-data" onsubmit="return setQuoteData(this)">
                
                    <div class='input-container'>
                            <div class="icon-ph"><i class="fa fa-map-marker fa-fw"></i></div>
                           <input class="custom-text" type="text" placeholder="Pickup Address?" data-role="none" id="pickup">
                            <div class="icon-qh" id="my-locatipn"><i class="fa fa-search fa-fw"></i></div>                           
                    </div>
                    
					<div class='input-container'>
                            <div class="icon-ph"><i class="fa fa-location-arrow fa-fw"></i></div>
                           <input class="custom-text" type="text" placeholder="Dropoff Address?" data-role="none" id="dropoff">
                    </div>
                    
                    <div class='input-container'>
                    		<select id="taxi_type" class="custom-text" data-role="none" name="data[tarif][taxi_type]">
								<option value="Choose">Choose One</option>
                                <option value="Silver">Silver</option>
								<option value="Black">Black</option>
                               <option value="White">White</option>
							</select>
                    </div>
                    <div class='input-container'>
                    		<select id="taxi_type" class="custom-text" data-role="none" name="data[tarif][vehicle_type]">
                            	<option value="Choose">Choose One</option>
								<option value="Sedan">Sedan</option>
								<option value="Station_Wagon">Station Wagon</option>
                               <option value="Micro">Micro</option>
							</select>
                    </div>
                    <div class='input-container'>
                       <div class="flip-1 ui-shadow-inset"><label>Click to show more details</label></div>
                       <div class="panel-1">
	
                                    <input type="checkbox" name="data[tarif][baby_seat]" data-role="none" />Baby Seat
                                    <input type="checkbox" name="data[tarif][wheel_chair]" data-role="none" />Wheel Chair
                       </div>
					</div>
                    <div class='input-container'>
                    <div class="icon-ph button-pointer"><i class="fa fa-chevron-left fa-fw"></i></div>

                           <input type="button" placeholder="Back" class="get-quote-back" data-role="none">
 <button type="submit" data-role="none" class="get-quote-continue" id="get-quote-continue">Continue</button>
                           <!--<a href="review-offer.html" data-transition="flip" style="color:#FFF"> <button type="submit" data-role="none" class="get-quote-continue" id="get-quote-continue">Continue</button></a> -->

                    </div>  
                    
                    <input type="hidden" name='controller' value="Tarifs"  />
					<input type="hidden" name='action' value="price"  />	
					<input type="hidden" name='callback' value="callbackTarif" />
					<input type="hidden" id="from_post_code" value="" name="data[tarif][location_from]" />
					<input type="hidden" id="to_post_code" value="" name="data[tarif][location_to]" /> 
					<input type="hidden" id="current_location_latitude" value="" name="data[tarif][current_lat]" /> 
					<input type="hidden" id="current_location_longitude" value="" name="data[tarif][current_lng]" />                                          
 
    			</form>
			 </div>
			
		<!-- InstanceEndEditable -->
		<div style="clear:both"></div>
	</div>
	<footer data-role="footer" data-position="fixed">
		
    <!-- InstanceBeginEditable name="EditableFooter" -->
	
	<!-- InstanceEndEditable -->
	</footer>
	</div>
	</div>
</body>
<!-- InstanceEnd --></html>
